{% macro metric(params) %}
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      <h3 class="govuk-heading-m" id="{{ params.id }}">
        {{ params.titleHTML | safe }}
      </h3>
    </div>

    <div class="govuk-grid-column-two-thirds">
        <p>{{ params.descriptionHTML | safe }}</p>

        <div>{{ params.metric.graph | safe }}</div>
    </div>
    <div class="govuk-grid-column-one-third govuk-!-padding-top-4">
      {% for series in params.metric.data.seriesArray %}
        <table class="govuk-table">
          <caption class="govuk-table__caption">{{ series.label | default('Instance') }}</caption>
          <tbody class="govuk-table__body">
            <tr class="govuk-table__row">
              <th scope="row" class="govuk-table__header"><small>Current</small></th>
              <td class="govuk-table__cell govuk-table__cell--numeric">
                <small>
                  {% if params.format === 'bytes' %}
                    {{ series.summary.current | bytestohuman | safe }}
                  {% elseif params.format === 'percentile' %}
                    {{ series.summary.current | round(2) }}%
                  {% else %}
                    {{ series.summary.current | round(2) }}
                  {% endif %}
                </small>
              </td>
            </tr>
            <tr class="govuk-table__row">
              <th scope="row" class="govuk-table__header"><small>Average</small></th>
              <td class="govuk-table__cell govuk-table__cell--numeric">
                <small>
                  {% if params.format === 'bytes' %}
                    {{ series.summary.average | bytestohuman | safe }}
                  {% elseif params.format === 'percentile' %}
                    {{ series.summary.average | round(2) }}%
                  {% else %}
                    {{ series.summary.average | round(2) }}
                  {% endif %}
                </small>
              </td>
            </tr>
            <tr class="govuk-table__row">
              <th scope="row" class="govuk-table__header"><small>Min</small></th>
              <td class="govuk-table__cell govuk-table__cell--numeric">
                <small>
                  {% if params.format === 'bytes' %}
                    {{ series.summary.min | bytestohuman | safe }}
                  {% elseif params.format === 'percentile' %}
                    {{ series.summary.min | round(2) }}%
                  {% else %}
                    {{ series.summary.min | round(2) }}
                  {% endif %}
                </small>
              </td>
            </tr>
            <tr class="govuk-table__row">
              <th scope="row" class="govuk-table__header"><small>Max</small></th>
              <td class="govuk-table__cell govuk-table__cell--numeric">
                <small>
                  {% if params.format === 'bytes' %}
                    {{ series.summary.max | bytestohuman | safe }}
                  {% elseif params.format === 'percentile' %}
                    {{ series.summary.max | round(2) }}%
                  {% else %}
                    {{ series.summary.max | round(2) }}
                  {% endif %}
                </small>
              </td>
            </tr>
          </tbody>
        </table>
      {% endfor %}
    </div>
  </div>
{% endmacro %}
